<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research | JP Salomon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <meta name="description" content="Research papers by JP Salomon. Cognitive Science, AI Alignment, Complexity.">
    <link rel="stylesheet" href="css/styles.css">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "CollectionPage",
      "name": "Research by JP Salomon",
      "url": "https://jpsalomon.github.io/research.html",
      "author": { "@type": "Person", "name": "JP Salomon" }
    }
    </script>

    <style>
        body {
            background-color: #fcfcfc;
            color: #111827;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 32px 32px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2.5rem;
            padding: 3rem 0;
        }

        /* Card with "Character" */
        .paper-card {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 2px;
            /* Sharper, technical feel */
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }

        .paper-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            border-color: #9ca3af;
        }

        /* Topological Decoration */
        .card-topo-bg {
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            opacity: 0.1;
            /* Subtle */
            pointer-events: none;
            background-image: repeating-linear-gradient(45deg, #000 0, #000 1px, transparent 0, transparent 50%);
            background-size: 10px 10px;
            mask-image: radial-gradient(circle at top right, black, transparent 70%);
        }

        .tag-pill {
            display: inline-block;
            font-family: 'Inter', sans-serif;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-weight: 700;
            padding: 0.35rem 0.6rem;
            border: 1px solid #e5e7eb;
            margin-bottom: 1.25rem;
            color: #4b5563;
            background-color: #fff;
        }

        /* Action Buttons */
        .card-action {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 0.5rem 0;
            color: #6b7280;
            transition: color 0.2s;
            cursor: pointer;
        }

        .card-action:hover {
            color: #111827;
            text-decoration: underline;
            text-decoration-thickness: 1px;
            text-underline-offset: 4px;
        }

        .shiny-btn {
            background: #111827;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 2px;
            text-align: center;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: background 0.2s;
        }

        .shiny-btn:hover {
            background: #374151;
            text-decoration: none;
        }

        /* Reader Modal */
        #reader-modal {
            transition: opacity 0.2s ease;
            opacity: 0;
            pointer-events: none;
        }

        #reader-modal.open {
            opacity: 1;
            pointer-events: all;
        }
    </style>
</head>

<body class="font-sans antialiased">

    <nav class="sticky top-0 z-50 bg-[#fcfcfc]/95 backdrop-blur-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html"
                class="text-xs font-bold uppercase tracking-widest text-gray-500 hover:text-black flex items-center gap-2 group">
                <i data-lucide="arrow-left" class="w-4 h-4 group-hover:-translate-x-1 transition-transform"></i>
                <span>Index</span>
            </a>
            <span class="font-serif text-lg font-medium tracking-tight">Archives</span>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 py-12">
        <header class="mb-16 max-w-4xl border-b border-gray-200 pb-8">
            <p class="text-xs font-bold uppercase tracking-[0.2em] text-gray-400 mb-4">The Collection</p>
            <h1 class="font-serif text-5xl md:text-6xl mb-6 text-gray-900 leading-none">Topology of Mind</h1>
            <p class="text-lg text-gray-600 leading-relaxed max-w-2xl font-light">
                Whitepapers and technical reports exploring the structural isomorphism between biological cognition and
                artificial intelligence.
            </p>
        </header>

        <div id="papers-grid" class="grid-container">
            <!-- Injected by JS -->
        </div>
    </main>

    <!-- Reader Modal -->
    <div id="reader-modal"
        class="fixed inset-0 z-[60] flex items-center justify-center p-2 md:p-6 bg-white/95 backdrop-blur-sm">
        <div class="w-full h-full max-w-6xl bg-white shadow-2xl border border-gray-200 flex flex-col overflow-hidden">
            <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100">
                <h3 id="reader-title" class="font-serif text-lg truncate pr-4">Paper Title</h3>
                <div class="flex items-center gap-4">
                    <a id="reader-download" href="#" target="_blank" download
                        class="text-xs uppercase tracking-wider text-gray-500 hover:text-black flex items-center gap-2 transition-colors">
                        <i data-lucide="download" class="w-4 h-4"></i> PDF
                    </a>
                    <button onclick="closeReader()" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
            </div>
            <iframe id="reader-frame" class="w-full h-full bg-gray-50" src="about:blank"></iframe>
        </div>
    </div>

    <script src="js/manifest.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (window.lucide) lucide.createIcons();
            renderGrid();
        });

        function renderGrid() {
            const grid = document.getElementById('papers-grid');
            const papers = window.siteManifest?.papers || [];

            // Sort: Papers with site_link go first
            papers.sort((a, b) => {
                if (a.site_link && !b.site_link) return -1;
                if (!a.site_link && b.site_link) return 1;
                return 0; // Maintain original order otherwise
            });

            grid.innerHTML = papers.map(p => {
                // Conditional UI for extra links
                const siteBtn = p.site_link
                    ? `<a href="${p.site_link}" class="shiny-btn w-full mb-3">
                         <i data-lucide="zap" class="w-3 h-3"></i> Interactive Framework
                       </a>`
                    : '';

                return `
                <article class="paper-card group">
                    <div class="card-topo-bg"></div>
                    <div class="p-8 pb-4 relative z-10 flex-grow">
                        <div class="flex justify-between items-start">
                            <span class="tag-pill">${p.tag}</span>
                            <span class="text-[10px] uppercase tracking-wider text-gray-400 font-mono mt-1">${p.year}</span>
                        </div>
                        <h2 class="font-serif text-2xl font-medium mb-4 text-gray-900 leading-tight group-hover:underline decoration-1 underline-offset-4">${p.title}</h2>
                        <p class="text-sm text-gray-600 leading-relaxed font-light line-clamp-3">${p.desc}</p>
                    </div>
                    
                    <div class="px-8 pb-8 pt-4 relative z-10 mt-auto">
                        <!-- Primary Action: Interactive Site -->
                        ${siteBtn}

                        <div class="flex items-center justify-between pt-4 border-t border-gray-100">
                            <button onclick="openReader('${p.link}', '${p.title.replace(/'/g, "\\'")}')" 
                                class="card-action">
                                <i data-lucide="eye" class="w-3 h-3"></i> Read
                            </button>
                            
                            <a href="${p.link}" download target="_blank" class="card-action">
                                Download <i data-lucide="download" class="w-3 h-3"></i>
                            </a>
                        </div>
                    </div>
                </article>
            `}).join('');

            if (window.lucide) lucide.createIcons();
        }

        window.openReader = function (url, title) {
            const modal = document.getElementById('reader-modal');
            document.getElementById('reader-title').textContent = title;
            document.getElementById('reader-download').href = url;
            // Also update the download link in the modal!
            const downloadBtn = document.getElementById('reader-download');
            if (downloadBtn) {
                downloadBtn.href = url;
                downloadBtn.setAttribute('download', '');
            }

            document.getElementById('reader-frame').src = url;
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
        };

        window.closeReader = function () {
            const modal = document.getElementById('reader-modal');
            modal.classList.remove('open');
            setTimeout(() => { document.getElementById('reader-frame').src = 'about:blank'; }, 200);
            document.body.style.overflow = '';
        };

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeReader();
        });
    </script>
</body>

</html>